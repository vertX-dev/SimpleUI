<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple UI Builder</title>
  <style>
    /* Basic reset and fonts */
    body, html {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: sans-serif;
    }
    header {
      background: #333;
      color: white;
      padding: 10px;
      text-align: center;
    }
    /* Main container: grid and sidebar */
    .container {
      display: flex;
      flex-direction: row;
      height: calc(100vh - 50px);
    }
    /* Grid container (left 80% of screen) */
    .grid-container {
      width: 80%;
      height: 100%;
      position: relative;
      background-image:
        linear-gradient(to right, #ccc 1px, transparent 1px),
        linear-gradient(to bottom, #ccc 1px, transparent 1px);
      background-size: calc(100% / 32) calc(100% / 32);
    }
    /* Sidebar (right 20% of screen) */
    .sidebar {
      width: 20%;
      padding: 10px;
      box-sizing: border-box;
      border-left: 1px solid #ccc;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .sidebar img {
      max-width: 100%;
      height: auto;
      cursor: move;
    }
    .upload-btn {
      margin-top: 20px;
    }
    /* Responsive adjustments for mobile devices */
    @media(max-width: 768px) {
      .container {
        flex-direction: column;
      }
      .grid-container, .sidebar {
        width: 100%;
        height: 50vh;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Simple UI Builder</h1>
  </header>
  <div class="container">
    <div class="grid-container" id="grid-container"></div>
    <div class="sidebar">
      <img src="your-image.png" alt="Draggable" id="draggable-element" draggable="true">
      <input type="file" id="image-upload" accept="image/*" class="upload-btn">
    </div>
  </div>
  <script>
    const gridContainer = document.getElementById('grid-container');
    const draggableElement = document.getElementById('draggable-element');

    // Enhance dragstart: set drag data and a custom drag image
    draggableElement.addEventListener('dragstart', function(e) {
      e.dataTransfer.setData('text/plain', e.target.src);
      // Optionally, set a custom drag image (centered)
      if (e.dataTransfer.setDragImage) {
        const dragIcon = new Image();
        dragIcon.src = e.target.src;
        // Wait until the image is loaded
        dragIcon.onload = function() {
          e.dataTransfer.setDragImage(dragIcon, dragIcon.width / 2, dragIcon.height / 2);
        };
      }
    });

    // Allow drop over the grid container.
    gridContainer.addEventListener('dragover', function(e) {
      e.preventDefault();
    });

    gridContainer.addEventListener('drop', function(e) {
      e.preventDefault();
      const rect = gridContainer.getBoundingClientRect();
      const cellSize = rect.width / 32;
      const offsetX = e.clientX - rect.left;
      const offsetY = e.clientY - rect.top;
      const col = Math.floor(offsetX / cellSize);
      const row = Math.floor(offsetY / cellSize);

      // Create a new image element based on the dragged image.
      const img = document.createElement('img');
      img.src = e.dataTransfer.getData('text/plain');
      img.style.position = 'absolute';
      img.style.width = (cellSize * 16) + 'px';
      img.style.height = (cellSize * 16) + 'px';
      img.style.left = (col * cellSize) + 'px';
      img.style.top = (row * cellSize) + 'px';
      img.draggable = false;
      gridContainer.appendChild(img);
    });

    // Handle image upload: update the draggable element's image.
    const imageUpload = document.getElementById('image-upload');
    imageUpload.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          draggableElement.src = event.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // Note: HTML5 drag and drop does not work on many mobile browsers.
    // For mobile support, consider implementing touch event handlers or a library.
  </script>
</body>
</html>
